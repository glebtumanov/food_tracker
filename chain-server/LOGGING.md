# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Chain-Server

## –û–ø–∏—Å–∞–Ω–∏–µ

Chain-server –≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ñ–∞–π–ª –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `config.yaml`:

```yaml
logging:
  file: "logs/api_requests.log"  # –§–∞–π–ª –¥–ª—è –ª–æ–≥–æ–≤
  level: "INFO"                  # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
  max_size_mb: 50               # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (–ú–ë)
  backup_count: 5               # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
```

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- **DEBUG** - –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **INFO** - –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **WARNING** - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **ERROR** - –û—à–∏–±–∫–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–æ–≤

### Middleware –∑–∞–ø—Ä–æ—Å–æ–≤
```
[REQUEST] GET /health from 127.0.0.1 | UA: Mozilla/5.0...
[RESPONSE] GET /health | Status: 200 | Time: 0.045s | IP: 127.0.0.1
```

### –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```
[ANALYZE] –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | filename: image.jpg
[ANALYZE] –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ base64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: temp_images/abc123.jpg
[ANALYZE] –ù–∞—á–∏–Ω–∞—é –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: temp_images/abc123.jpg
[ANALYZE] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω | –±–ª—é–¥: 2 | —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 95.00%
```

### –ê–Ω–∞–ª–∏–∑ –Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤
```
[NUTRIENTS] –ó–∞–ø—Ä–æ—Å –∞–Ω–∞–ª–∏–∑–∞ –Ω—É—Ç—Ä–∏–µ–Ω—Ç–æ–≤ | –±–ª—é–¥–æ: 'Oatmeal' | –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: 250.0 –≥—Ä–∞–º–º
[NUTRIENTS] –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω –¥–ª—è 'Oatmeal' | –∫–∞–ª–æ—Ä–∏–∏: 389.0 –∫–∫–∞–ª | –±–µ–ª–∫–∏: 16.9 –≥
```

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–µ—Ä–≤–µ—Ä–∞
```
[STARTUP] –ó–∞–ø—É—Å–∫ chain-server...
[STARTUP] ‚úÖ –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
[STARTUP] ‚úÖ –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ø–∏—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
[STARTUP] üöÄ Chain-server –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
[SHUTDOWN] –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã chain-server...
```

## –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤

–õ–æ–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞:
- –¢–µ–∫—É—â–∏–π –ª–æ–≥: `api_requests.log`
- –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏: `api_requests.log.1`, `api_requests.log.2`, –∏ —Ç.–¥.

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
```bash
tail -f logs/api_requests.log
```

### –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
```bash
grep "ERROR" logs/api_requests.log
```

### –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```bash
grep "Time:" logs/api_requests.log | awk '{print $NF}' | sort -n
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
```bash
grep "\[REQUEST\]" logs/api_requests.log | awk '{print $3}' | sort | uniq -c
```

## –ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª–µ–∑–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

```bash
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–µ–≥–æ–¥–Ω—è
grep "$(date '+%Y-%m-%d')" logs/api_requests.log | grep "\[REQUEST\]" | wc -l

# –°–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
grep "Time:" logs/api_requests.log | sort -k9 -nr | head -10

# –û—à–∏–±–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
grep "$(date -d '1 hour ago' '+%Y-%m-%d %H')" logs/api_requests.log | grep "ERROR"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –º–µ—Ç–æ–¥–∞–º HTTP
grep "\[REQUEST\]" logs/api_requests.log | awk '{print $3}' | sort | uniq -c | sort -nr
```